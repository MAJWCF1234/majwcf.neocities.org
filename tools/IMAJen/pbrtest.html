<!DOCTYPE html>
<html lang=en><head><meta charset=utf-8><title>PBR Texture Demo</title><meta name=viewport content="width=device-width, initial-scale=1"><style>body{margin:0;overflow:hidden;background:#1a1a1a;color:#eee;font-family:sans-serif}canvas{display:block}#ui{position:absolute;top:10px;left:10px;background:#282828d9;padding:15;border-radius:5;width:240px;max-height:calc(100vh - 20px);overflow-y:auto;z-index:10}#ui h3{margin:0 0 10px;color:#0af;font-size:1.1em}#ui label{display:block;margin:10px 0 4px;font-size:0.9em}#ui select,#ui input[type=number],#ui input[type=range]{width:100%;padding:6;margin-bottom:12;background:#333;color:#eee;border:1px solid #555;border-radius:3;box-sizing:border-box}#ui .input-group{display:flex;gap:5px;align-items:center}#ui .input-group label{margin:0 5px 0 0;flex-shrink:0;width:20px;text-align:right}#ui .input-group input[type=number]{margin-bottom:0}#ui .slider-value{font-size:0.8em;color:#bbb;margin-left:5px;min-width:30px;text-align:right}.canvas-container{position:absolute;top:0;left:260px;width:calc(100% - 260px);height:100% }#texture-grid-info{position:absolute;bottom:10px;left:270px;color:#bbb;font-size:0.8em;background:#0009;padding:5 8;border-radius:3;z-index:5}</style></head><body>
<div id=ui><h3>Test Textures</h3><div><label for=baseColorSelect>Base Color:</label><select id=baseColorSelect></select></div><div><label for=roughnessMapSelect>Roughness Map:</label><select id=roughnessMapSelect></select></div><div><label for=normalMapSelect>Normal Map:</label><select id=normalMapSelect></select></div><div><label for=aoMapSelect>AO Map:</label><select id=aoMapSelect></select></div><div><label for=metalnessSlider>Metalness: <span id=metalnessValue class=slider-value>.1</span></label><input type=range id=metalnessSlider min=0 max=1 step=.01 value=.1></div><div><label for=roughnessSlider>Roughness (no map): <span id=roughnessValue class=slider-value>.7</span></label><input type=range id=roughnessSlider min=0 max=1 step=.01 value=.7></div><div><label>Normal Scale:</label><div class=input-group><label for=normalScaleX>X:</label><input type=number id=normalScaleX step=.1 value=1><label for=normalScaleY>Y:</label><input type=number id=normalScaleY step=.1 value=1></div></div></div><div class=canvas-container><canvas id=pbrCanvas></canvas></div><div id=texture-grid-info>Grid: Auto-applied. Test Cube: Center, interactive.</div>
<script src=https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js></script><script src=https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js></script><script>
const IP='images/',TP='horror_',TS='.png',Oa=Object.assign,D=document,GE=id=>D.getElementById(id),CE=el=>D.createElement(el),QS=sel=>D.querySelector(sel),L=(o,e,f)=>o.addEventListener(e,f),T=THREE,TL=T.TextureLoader,LE=T.LinearEncoding,SE=T.sRGBEncoding,RW=T.RepeatWrapping,Sc=T.Scene,Co=T.Color,PCam=T.PerspectiveCamera,WGLR=T.WebGLRenderer,ACESTM=T.ACESFilmicToneMapping,PCFSM=T.PCFSoftShadowMap,HL=T.HemisphereLight,DiL=T.DirectionalLight,V3=T.Vector3,V2=T.Vector2,BoxG=T.BoxGeometry,BufA=T.BufferAttribute,MSM=T.MeshStandardMaterial,Msh=T.Mesh,Grp=T.Group,sTNs=["bricks_color","bricks_height","bricks_normal","carpet_color","carpet_height","carpet_normal","ceiling_tile_color","ceiling_tile_glitched_color","ceiling_tile_glitched_height","ceiling_tile_glitched_normal","ceiling_tile_height","ceiling_tile_normal","chain_fence_color","chain_fence_height","chain_fence_normal","concrete_color","concrete_height","concrete_normal","crate_color","crate_height","crate_normal","dirt_color","dirt_height","dirt_normal"],texP=sTNs.map(sn=>IP+TP+sn+TS),tLdr=new TL(),ldTex={},ui={},dTSfx=/(_(normal|height|ao|roughness|metallic|specular)|(Normal|Height|AO|Roughness|Metallic|Specular))\./;
for(const id of ['baseColorSelect','roughnessMapSelect','normalMapSelect','aoMapSelect','metalnessSlider','roughnessSlider','normalScaleX','normalScaleY','metalnessValue','roughnessValue','pbrCanvas'])ui[id]=GE(id);let scn,cam,rnd,oCtrl,tObj,tMat,maxA,cCont,nLoad=texP.length,nLoaded=0;const cLDone=()=>{if(++nLoaded>=nLoad){mkGrid();updMat()}},gTex=p=>{const t=ldTex[p];if(t)t.anisotropy=maxA;return t},onRsz=()=>{cam.aspect=cCont.clientWidth/cCont.clientHeight;cam.updateProjectionMatrix();rnd.setSize(cCont.clientWidth,cCont.clientHeight)};
function loadTex(){if(nLoad===0)return cLDone();texP.forEach(p=>{tLdr.load(p,t=>{t.encoding=dTSfx.test(p)?LE:SE;t.wrapS=t.wrapT=RW;ldTex[p]=t;cLDone()},undefined,()=>{ldTex[p]=null;cLDone()})})};function fillDDs(){['baseColorSelect','roughnessMapSelect','normalMapSelect','aoMapSelect'].forEach((sId,i)=>{const o=CE('option');o.value='';o.textContent=['None','None (Use Slider)','None (Flat Normal)','None'][i];ui[sId].appendChild(o);texP.forEach(p=>{const op=CE('option');op.value=p;op.textContent=p.substring(IP.length);ui[sId].appendChild(op)})})};function mkCube(){const g=new BoxG(1.2,1.2,1.2);g.setAttribute('uv2',new BufA(g.attributes.uv.array,2));tMat=new MSM({color:0xbbbbbb,metalness:+ui.metalnessSlider.value,roughness:+ui.roughnessSlider.value,aoMapIntensity:1,normalScale:new V2(1,1)});tObj=new Msh(g,tMat);tObj.castShadow=tObj.receiveShadow=true;tObj.position.y=0.75;scn.add(tObj)};function updMat(){if(!tMat)return;Oa(tMat,{map:ui.baseColorSelect.value?gTex(ui.baseColorSelect.value):null,roughnessMap:ui.roughnessMapSelect.value?gTex(ui.roughnessMapSelect.value):null,normalMap:ui.normalMapSelect.value?gTex(ui.normalMapSelect.value):null,aoMap:ui.aoMapSelect.value?gTex(ui.aoMapSelect.value):null,metalness:+ui.metalnessSlider.value,roughness:ui.roughnessMapSelect.value&&ldTex[ui.roughnessMapSelect.value]?1:+ui.roughnessSlider.value});tMat.normalScale.set(+ui.normalScaleX.value,+ui.normalScaleY.value);tMat.needsUpdate=true};function mkGrid(){const tMap={},sfxMap={'_color.':'color','_normal.':'normal','_height.':'height','_texture.':'color','_ao.':'ao'};sTNs.forEach(sn=>{let fn=TP+sn+TS,bn=fn.slice(0,-TS.length),ty='color';for(const sfx in sfxMap){if(fn.includes(sfx)){ty=sfxMap[sfx];bn=fn.substring(0,fn.lastIndexOf(sfx));break}}tMap[bn]=tMap[bn]||{};tMap[bn][ty]=IP+fn});const g=new BoxG(1,1,1);g.setAttribute('uv2',new BufA(g.attributes.uv.array,2));const sp=1.4,ipr=Math.max(5,Math.ceil(Math.sqrt(Object.keys(tMap).length)));let i=0;const grp=new Grp();for(const bn in tMap){const s=tMap[bn],m=new MSM({metalness:(s.color&&(s.color.includes('metal')||s.color.includes('rust')))?0.8:0.05,roughness:0.75,aoMapIntensity:1});if(s.color&&ldTex[s.color])m.map=gTex(s.color);else{const fk=Object.keys(s)[0];if(fk&&ldTex[s[fk]]&&!/_normal\.|_ao\./.test(s[fk]))m.map=gTex(s[fk]);else m.color=new Co(0x555555)}if(s.normal&&ldTex[s.normal])m.normalMap=gTex(s.normal);if(s.height&&ldTex[s.height]){m.roughnessMap=gTex(s.height);m.roughness=1}if(s.ao&&ldTex[s.ao])m.aoMap=gTex(s.ao);const b=new Msh(g,m);b.castShadow=b.receiveShadow=true;b.position.set((i%ipr-(ipr-1)/2)*sp,-1.7,Math.floor(i/ipr)*-sp-4);grp.add(b);i++}scn.add(grp)};function init(){scn=new Sc();scn.background=new Co(0x202025);cCont=QS('.canvas-container');cam=new PCam(50,cCont.clientWidth/cCont.clientHeight,0.1,1000);cam.position.set(0,1.5,4.5);rnd=new WGLR({canvas:ui.pbrCanvas,antialias:true});Oa(rnd,{physicallyCorrectLights:true,toneMapping:ACESTM,toneMappingExposure:1.1,outputEncoding:SE});Oa(rnd.shadowMap,{enabled:true,type:PCFSM});rnd.setSize(cCont.clientWidth,cCont.clientHeight);maxA=rnd.capabilities.getMaxAnisotropy();scn.add(new HL(0xffffff,0x444444,0.8));const dL=new DiL(0xffffff,1.5);dL.castShadow=true;dL.position.set(5,7,5);dL.shadow.mapSize.set(2048,2048);Oa(dL.shadow.camera,{near:0.5,far:30});dL.shadow.bias=-0.0005;scn.add(dL);oCtrl=new T.OrbitControls(cam,rnd.domElement);Oa(oCtrl,{target:new V3(0,0.75,0),enableDamping:true,minDistance:1,maxDistance:50});fillDDs();mkCube();loadTex();['baseColorSelect','roughnessMapSelect','normalMapSelect','aoMapSelect','normalScaleX','normalScaleY'].forEach(id=>L(ui[id],'change',updMat));L(ui.metalnessSlider,'input',e=>{ui.metalnessValue.innerText=(+e.target.value).toFixed(2);updMat()});L(ui.roughnessSlider,'input',e=>{ui.roughnessValue.innerText=(+e.target.value).toFixed(2);updMat()});L(window,'resize',onRsz);anim()};function anim(){requestAnimationFrame(anim);oCtrl.update();rnd.render(scn,cam)};L(D,'DOMContentLoaded',init);
</script></body></html>